function calDatagridBaseHeight(){var a=$(window).height()-38-(30+20+46+5);var b=screen.width;var c=screen.height;if(b<=1024){a-=16}return a}Commons=(function(){return{config:{datagrid_base_height1:calDatagridBaseHeight(),datagrid_base_height2:calDatagridBaseHeight()-34,datagrid_base_height3:calDatagridBaseHeight()-(34+34),modal_dialog_btnbar_height1:70,default_process_msg:"请求处理中，请稍后……",emptyDictArray:[{code:"",name:"请选择"}],responseStatus:{SUCCESS:"success",FAILURE:"failure",WARNING:"warning"},optype:{ADD:1,UPDATE:2}},renderer:{dictRender:function(d,b){if(d==null||d.length==0){return""}if(Commons.isEmpty(b)){return""}for(var c=0;c<d.length;c++){var a=d[c];if(a.code==b){return a.name}}return b},dateRender:function(a){if(Commons.isEmpty(a)){return""}var b=/\d{4}\-\d{2}\-\d{2}/gi;return a.match(b)},timeRender:function(b){if(Commons.isEmpty(b)){return""}var c=/\d{4}\-\d{2}\-\d{2}/gi;var a=/\d{2}:\d{2}:\d{2}/gi;return b.match(c)+" "+b.match(a)}},nullToString:function(a){if(a==null||a=="null"||a=="undefined"){return""}return a},isEmpty:function(a){return(a==null||a=="null"||a=="undefined"||a.length==0)},trim:function(a){return a.replace(/(^s*)|(s*$)/g,"")},createHTMLElsFromDict:function(e,a,b){if(e==null||e.length==0){return}if(!b||!b.type){alert("调用Common.createHTMLElsFromDict时参数config为空或config.type为空.");return}var d="";for(var c=0;c<e.length;c++){if(b.type=="radio"||b.type=="checkbox"){d+='&nbsp;&nbsp;<input type="'+b.type+'" value="'+e[c].code+'"';if(b.elId){d+=' id="'+b.elId+'"'}if(b.elName){d+=' name="'+b.elName+'"'}if((b&&b.defaultValue==e[c].code)||((!b||!b.defaultValue)&&c==0)){d+=' checked="checked"'}if(b.elClass){d+=' class="'+b.elClass+'"'}d+="/>&nbsp;"+e[c].value+"&nbsp;&nbsp;"}else{if(b.type=="option"){d+='<option value="'+e[c].code+'"';if(b.elId){d+=' id="'+b.elId+'"'}if(b.elName){d+=' name="'+b.elName+'"'}if((b&&b.defaultValue==e[c].code)||((!b||!b.defaultValue)&&c==0)){d+=' selected="selected"'}d+=">"+e[c].name+"</option>"}}}$("#"+a).html(d)},parent:function(){return parent.frames["main"]},absoluteUrl:function(a){return"/privilege-console"+a},random:function(){return parseInt(10000*Math.random())},replace:function(a,b){a.replace(b)},alert:function(g,a,f,e,c){var d="warning";if(e=="error"){d="error"}else{if(e=="alert"){d="warning"}else{if(e=="attention"){d="attention"}else{if(e=="success"){d="succeed"}}}}var b=$.dialog({title:a,content:g,lock:true,fixed:true,icon:d,close:function(){if(c){setTimeout(function(){c()},100)}return true},ok:true});return b},showError:function(d,a,c,b){if(undefined==a||""==a){a="错误提示"}else{if($.isFunction(a)){b=a;a="错误提示"}else{if(typeof(a)=="number"){if(undefined!=c){if($.isFunction(c)){b=c}}c=a;a="错误提示"}}}if(undefined!=c){if($.isFunction(c)){b=c;c=undefined}}return Commons.alert(d,a,c,"error",b)},showWarn:function(d,a,c,b){if(undefined==a||""==a){a="警告提示"}else{if($.isFunction(a)){b=a;a="警告提示"}else{if(typeof(a)=="number"){if(undefined!=c){if($.isFunction(c)){b=c}}c=a;a="警告提示"}}}if(undefined!=c){if($.isFunction(c)){b=c;c=undefined}}return Commons.alert(d,a,c,"alert",b)},showInfo:function(d,a,c,b){if(undefined==a||""==a){a="消息提示"}else{if($.isFunction(a)){b=a;a="消息提示"}else{if(typeof(a)=="number"){if(undefined!=c){if($.isFunction(c)){b=c}}c=a;a="消息提示"}}}if(undefined!=c){if($.isFunction(c)){b=c;c=undefined}}return Commons.alert(d,a,c,"attention",b)},showSuccess:function(e,a,d,c){if(undefined==a||""==a){a="成功提示"}else{if($.isFunction(a)){c=a;a="成功提示"}else{if(typeof(a)=="number"){if(undefined!=d){if($.isFunction(d)){c=d}}d=a;a="成功提示"}}}if(undefined!=d){if($.isFunction(d)){c=d;d=undefined}}var b=Commons.alert(e,a,d,"success",c);b.time(1);return b},showModalDialog:function(b){var a=b||{};$.dialog.open(a.url,{title:a.title,width:a.width,height:a.height,lock:true,padding:"6px",resize:false})},closeModalDialog:function(b){var a=b||{};$.dialog.open.api.close();if(a&&a.callback){a.callback()}},getModalDialogParent:function(){return $.dialog.parent},getModalDialogHeight:function(){return $(window).height()-40},getModalDialogWidth:function(){return $(window).width()-20},dialog:function(f){var d=f||{};var e={cancel:function(){this.hide();return false},close:function(){this.hide();return false}};d=$.extend(e,d);d.padding="6px";d.lock=true;if(d.id){var b='<div id="'+d.id+'" ';var c=d.width;var a=d.height;if(d.width||d.height){b+='style="';if(!d.overflow&&((c&&c!="auto")||(a&&a!="auto"))){b+="overflow: auto;"}else{if(d.overflow){b+="overflow: "+d.overflow+";"}}if(c){b+="width: "+(c-6)+"px;"}if(a){b+="height: "+(a-26)+"px;"}b+='"'}b+=">"+d.content+"</div>";d.content=b}$.dialog(d)},getDialogWidth:function(){return $(window).width()-20},getDialogHeight:function(){return $(window).height()-96},hideDialog:function(a){$.dialog.list[a].hide()},showDialog:function(a){$.dialog.list[a].show()},changeDialog:function(c,b){var a=b||{};if(a.title){$.dialog.list[c].title(a.title)}if(a.content){$.dialog.list[c].content(a.content)}},confirm:function(b){var a=b||{};$.dialog({width:a.width||"auto",title:a.title||"确认提示",content:a.content,icon:"question",ok:function(){if(a.onConfirm){a.onConfirm()}return true},cancelVal:"关闭",cancel:true})},showProcessMsg:function(a){$.blockUI({message:a})},hideProcessMsg:function(){$.unblockUI()},showServiceResponseMsg:function(a,b){if(!a||!a.status||!a.status.result){this.showError("请求失败!")}else{if(a.status.result==this.config.responseStatus.SUCCESS){this.showSuccess(b&&b.successMsg?b.successMsg:a.status.message,b.successCallback)}else{if(!a.responses&&a.status.result==this.config.responseStatus.FAILURE){this.showError(parseInt(a.status.errorCode)<200?a.status.message:"系统错误")}else{if(a.responses&&a.responses.length==1&&a.status.result==this.config.responseStatus.FAILURE){this.showError(parseInt(a.responses[0].status.errorCode)<200?a.responses[0].status.message:"系统错误")}else{if(a.status.result==this.config.responseStatus.WARNING){this.showWarn("此次共处理数："+a.responses.length+"，其中成功数："+a.successCount+"，失败数："+a.failureCount)}}}}}},addUrlParameter:function(a,b){if(a.indexOf("?")<0){a+="?"}if(a.indexOf("&")>0||a.lastIndexOf("?")!=(a.length-1)){a+="&"}return a+b},selectOption:function(a,b){$(a).find("option[value='"+b+"']").attr("selected",true)}}})();$(document).ready(function(){function c(){if($(".base-page-content").length>0){if($.browser.msie){$(".base-page-content").css("height",$(window).height()-38)}else{$(".base-page-content").css("min-height",$(window).height()-38)}}}function a(){if($.browser.msie&&$.browser.version<8){return}if($(".base-page-content .search table").length>0&&$(".search table tr").length>1){$(".base-page-content .search table").css("width","98%");$(".base-page-content .search table tr td.form-text input[type='text']").css("width","96%");$(".base-page-content .search table tr td.form-text select").css("width","99.6%")}}function b(){if($(".modal-dialog").length>0){$("body").addClass("modal-dialog-body")}}c();a();b()});Date.prototype.format=function(b){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var a in c){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,RegExp.$1.length==1?c[a]:("00"+c[a]).substr((""+c[a]).length))}}return b};String.prototype.format=function(b){var a=this;if(arguments.length>0){if(arguments.length==1&&typeof(b)=="object"){for(var d in b){if(b[d]!=undefined){var e=new RegExp("({"+d+"})","g");a=a.replace(e,b[d])}}}else{for(var c=0;c<arguments.length;c++){if(arguments[c]!=undefined){var e=new RegExp("({)"+c+"(})","g");a=a.replace(e,arguments[c])}}}}return a};var sessionExpired=false;(function(){var a=jQuery.ajax;jQuery.extend({ajax:function(b){if(b.cache==null){b.cache=false}if(b.traditional==null){b.traditional=true}var e=b.success;var c=b.error;var d=function(f,i,h){if(f==401){if(!sessionExpired){sessionExpired=true;var i=Commons.isEmpty(i)?"未认证或会话超时！":decodeURI(i);var g=Commons.showWarn(i,function(){location.reload(true)});setTimeout(function(){g.close()},2000)}return true}else{if(f==403){Commons.showWarn("无访问权限！");return true}else{if(f==500){Commons.showError("系统内部错误！");return true}else{if(f==200){var i=Commons.isEmpty(i)?"请求失败！":decodeURI(i);Commons.showError(i);return true}}}}return false};b.success=function(j,f,i){var h=i.getResponseHeader("httpStatus");var g=false;if(!Commons.isEmpty(h)){g=d(parseInt(h),i.getResponseHeader("msg"),i.getResponseHeader("code"))}if(e&&!g){e(j,f,i)}};b.error=function(f){var g=d(f.status);if(c&&!g){c.apply(this,f)}};a(b)}})})();